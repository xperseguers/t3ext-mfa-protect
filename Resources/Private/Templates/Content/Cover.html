<html xmlns:f="http://typo3.org/ns/TYPO3/CMS/Fluid/ViewHelpers"
      data-namespace-typo3-fluid="true">

<f:if condition="{isFirstOnPage}">
    <link rel="stylesheet" href="{f:uri.resource(path: 'Css/otp.css')}" media="all"/>
</f:if>

<div class="mfaprotect">
    <h4 class="alert-heading">Protected content</h4>

    <f:if condition="{isFirstOnPage}">
        <f:if condition="{hasMfa}">
            <f:then>
                <f:render section="OTP"/>
            </f:then>
            <f:else>
                <f:render section="ConfigureMfa"/>
            </f:else>
        </f:if>
    </f:if>
</div>

<f:section name="OTP">
    <f:comment>
        <!--
        Please note that the minimal suggested markup if you want to
        customize this template is as follows:
        -->
        <form method="post">
            <input type="text" name="tx_mfaprotect_otp" pattern="[0-9]*" maxlength="6" inputmode="numeric" autocomplete="one-time-code">
            <button type="submit">OK</button>
        </form>
    </f:comment>

    <p>Enter the code generated on your mobile device below to show.</p>

    <form method="post" class="mfaprotect-digits" autocomplete="off">
        <input type="hidden" id="mfaprotect-otp" name="tx_mfaprotect_otp" value=""/>

        <div class="otp-input-fields">
            <input type="number" class="otp__digit otp__field__1"/>
            <input type="number" class="otp__digit otp__field__2"/>
            <input type="number" class="otp__digit otp__field__3"/>
            <input type="number" class="otp__digit otp__field__4"/>
            <input type="number" class="otp__digit otp__field__5"/>
            <input type="number" class="otp__digit otp__field__6"/>
        </div>
    </form>

    <script src="{f:uri.resource(path: 'JavaScript/otp.js')}"></script>
</f:section>

<f:section name="ConfigureMfa">
    Please configure MFA for your account in order to access this content.

    <f:if condition="{settings.setupMfaUid}">
        <br/>
        <f:link.page pageUid="{settings.setupMfaUid}">Click here to proceed</f:link.page>
    </f:if>
</f:section>

</html>
